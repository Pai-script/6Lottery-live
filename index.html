<!DOCTYPE html>
<html lang="my">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Kozaw Gyi</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --bg: #ffe5e5;
      --card: #ffffff;
      --muted: #7f1d1d;
      --accent: #ef4444;
      --big: #dc2626;
      --small: #f97316;
      --profit: #f97316;
      --loss: #991b1b;
      --neutral: #d4d4d4;
      --text: #1c1917;
      --header-bg: rgba(255, 255, 255, 0.95);
      --login-bg: #fef2f2;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Inter', system-ui, -apple-system, Roboto, sans-serif;
      background: linear-gradient(135deg, #fee2e2 0%, #fef2f2 100%);
      color: var(--text);
      line-height: 1.5;
      padding: 16px;
      min-height: 100vh;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      font-size: 16px;
    }
    
    /* Login Screen */
    #loginScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--login-bg);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 0.5s ease;
    }
    
    .login-container {
      width: 100%;
      max-width: 400px;
      background: var(--card);
      padding: 24px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    
    .logo {
      width: 64px;
      height: 64px;
      background: linear-gradient(135deg, var(--accent), #f87171);
      border-radius: 50%;
      margin: 0 auto 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .logo i {
      font-size: 28px;
      color: #ffffff;
    }
    
    h1 {
      font-size: 24px;
      margin: 0 0 12px 0;
      color: var(--text);
      font-weight: 600;
    }
    
    .subtitle {
      color: var(--muted);
      margin-bottom: 24px;
      font-size: 14px;
    }
    
    .input-group {
      margin-bottom: 20px;
      position: relative;
    }
    
    .input-group i {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted);
    }
    
    input {
      width: 100%;
      padding: 12px 12px 12px 40px;
      background: #fef2f2;
      border: 1px solid #d4d4d4;
      border-radius: 8px;
      outline: none;
      color: var(--text);
      font-size: 16px;
      transition: all 0.3s ease;
    }
    
    input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
    }
    
    .btn {
      width: 100%;
      padding: 12px;
      background: var(--accent);
      border: none;
      border-radius: 8px;
      color: #ffffff;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .btn:hover {
      background: #dc2626;
      transform: translateY(-2px);
    }
    
    .message {
      margin-top: 16px;
      padding: 10px;
      border-radius: 8px;
      background: rgba(239, 68, 68, 0.1);
      color: var(--loss);
      font-size: 14px;
      display: none;
    }
    
    .protection-note {
      margin-top: 16px;
      padding: 10px;
      background: #fef2f2;
      border-radius: 8px;
      font-size: 12px;
      color: var(--muted);
    }
    
    .contact-developer {
      margin-top: 16px;
      font-size: 14px;
    }
    
    .contact-developer a {
      color: var(--accent);
      text-decoration: none;
      font-weight: 500;
    }
    
    .contact-developer a:hover {
      text-decoration: underline;
    }
    
    /* Prediction Content */
    #predictionContent {
      display: none;
    }
    
    .wrap {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    header {
      background: var(--header-bg);
      backdrop-filter: blur(12px);
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 12px;
    }
    
    .header-content {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    
    .controls {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    
    button.secondary {
      background: #fef2f2;
      border: 1px solid #d4d4d4;
      color: var(--text);
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    
    button.secondary:hover {
      background: #fee2e2;
      border-color: var(--accent);
      color: var(--accent);
    }
    
    .lead {
      font-size: 14px;
      color: var(--muted);
    }
    
    .dashboard {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      margin-bottom: 16px;
    }
    
    .card {
      background: var(--card);
      padding: 16px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-4px);
    }
    
    .card-title {
      font-size: 16px;
      color: var(--text);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
    }
    
    .stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }
    
    .stat {
      background: #fef2f2;
      padding: 12px;
      border-radius: 8px;
      text-align: center;
    }
    
    .stat-value {
      font-size: 20px;
      font-weight: 700;
      margin: 8px 0;
    }
    
    .stat-label {
      font-size: 12px;
      color: var(--muted);
    }
    
    .big-stat {
      color: var(--big);
    }
    
    .small-stat {
      color: var(--small);
    }
    
    .profit-stat {
      color: var(--profit);
    }
    
    .loss-stat {
      color: var(--loss);
    }
    
    .prediction-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 16px 0;
    }
    
    .prediction {
      font-size: 28px;
      font-weight: 800;
      padding: 12px 32px;
      border-radius: 12px;
      margin: 12px 0;
      text-align: center;
      min-width: 160px;
    }
    
    .big {
      background: rgba(220, 38, 38, 0.1);
      color: var(--big);
      box-shadow: 0 0 12px rgba(220, 38, 38, 0.2);
    }
    
    .smallc {
      background: rgba(249, 115, 22, 0.1);
      color: var(--small);
      box-shadow: 0 0 12px rgba(249, 115, 22, 0.2);
    }
    
    .prediction-label {
      font-size: 14px;
      color: var(--muted);
      margin-top: 8px;
    }
    
    .ai-analysis {
      margin-top: 16px;
      padding: 12px;
      background: #fef2f2;
      border-radius: 8px;
      font-size: 14px;
    }
    
    .trend-chart {
      height: 160px;
      margin-top: 16px;
      display: flex;
      align-items: flex-end;
      gap: 4px;
      padding: 12px;
      background: #fef2f2;
      border-radius: 8px;
    }
    
    .bar {
      flex: 1;
      background: var(--neutral);
      border-radius: 4px 4px 0 0;
      transition: height 0.5s ease;
      position: relative;
    }
    
    .bar-big {
      background: var(--big);
    }
    
    .bar-small {
      background: var(--small);
    }
    
    .bar-label {
      position: absolute;
      bottom: -18px;
      left: 0;
      right: 0;
      text-align: center;
      font-size: 10px;
      color: var(--muted);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
    }
    
    th, td {
      padding: 12px;
      border-bottom: 1px solid #fee2e2;
      text-align: left;
      font-size: 14px;
    }
    
    th {
      color: var(--muted);
      font-weight: 600;
      background: #fef2f2;
    }
    
    tr:last-child td {
      border-bottom: none;
    }
    
    .status {
      font-weight: 600;
      margin-left: 8px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    
    .error {
      color: var(--loss);
      background: rgba(239, 68, 68, 0.1);
      padding: 12px;
      border-radius: 8px;
      margin-top: 16px;
      font-size: 14px;
    }
    
    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 8px;
    }
    
    .badge-big {
      background: rgba(220, 38, 38, 0.1);
      color: var(--big);
    }
    
    .badge-small {
      background: rgba(249, 115, 22, 0.1);
      color: var(--small);
    }
    
    .badge-profit {
      background: rgba(249, 115, 22, 0.1);
      color: var(--profit);
    }
    
    .badge-loss {
      background: rgba(220, 38, 38, 0.1);
      color: var(--loss);
    }
    
    .pulse {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
      20%, 40%, 60%, 80% { transform: translateX(5px); }
    }
    
    .menu-bar {
      display: flex;
      justify-content: space-around;
      background: var(--card);
      padding: 8px;
      border-radius: 8px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    
    .menu-item {
      padding: 8px 16px;
      cursor: pointer;
      border-radius: 6px;
      transition: all 0.3s ease;
      font-size: 14px;
      color: var(--muted);
      font-weight: 500;
    }
    
    .menu-item.active {
      background: var(--accent);
      color: #ffffff;
    }
    
    .menu-item:hover {
      background: #fee2e2;
    }
    
    .section {
      display: none;
    }
    
    .section.active {
      display: block;
    }
    
    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: flex-start;
        padding: 12px;
      }
      
      .controls {
        width: 100%;
        justify-content: center;
      }
      
      .dashboard {
        grid-template-columns: 1fr;
      }
      
      .menu-bar {
        flex-direction: column;
        gap: 8px;
      }
      
      .menu-item {
        padding: 10px;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <!-- Login Screen -->
  <div id="loginScreen">
    <div class="login-container">
      <div class="logo">
        <i class="fas fa-lock"></i>
      </div>
      
      <h1>Secure Access Required</h1>
      <p class="subtitle">Enter password to access prediction system</p>
      
      <div class="input-group">
        <i class="fas fa-key"></i>
        <input type="password" id="passwordInput" placeholder="Enter your password">
      </div>
      
      <button class="btn" id="loginBtn"><i class="fas fa-sign-in-alt"></i> Access System</button>
      
      <div class="message" id="message">
        <i class="fas fa-exclamation-circle"></i> Incorrect password. Please try again.
      </div>
      <div class="contact-developer">
        Need help? <a href="https://t.me/zawzawaung700000" target="_blank">Contact Developer</a>
      </div>
    </div>
  </div>
  
  <!-- Prediction Content -->
  <div id="predictionContent">
    <div class="wrap">
      <header>
        <div class="header-content">
          <h1><i class="fas fa-brain" style="color: #dc2626; margin-right: 10px;"></i>6LOTTERY LIVE</h1>
          <p class="lead"></p>
        </div>
        <div class="controls">
          <button id="fetchBtn" class="secondary"><i class="fas fa-sync-alt"></i> Fetch & Predict</button>
        </div>
      </header>

      <div class="menu-bar">
        <div class="menu-item active" data-section="statistics">Statistics</div>
        <div class="menu-item" data-section="ai-prediction">AI Prediction</div>
        <div class="menu-item" data-section="performance">Performance</div>
        <div class="menu-item" data-section="history">History Data</div>
      </div>
      


      <div class="dashboard">
        <div id="statistics" class="card section active">
          <div class="card-title"><i class="fas fa-chart-line"></i> Statistics</div>
          <div class="stats">
            <div class="stat">
              <div class="stat-label">Total Results</div>
              <div class="stat-value" id="totalCount">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">BIG Results</div>
              <div class="stat-value big-stat" id="bigCount">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">SMALL Results</div>
              <div class="stat-value small-stat" id="smallCount">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">BIG Ratio</div>
              <div class="stat-value" id="bigRatio">0%</div>
            </div>
            <div class="stat">
              <div class="stat-label">Current Streak</div>
              <div class="stat-value" id="currentStreak">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">Max Streak</div>
              <div class="stat-value" id="maxStreak">0</div>
            </div>
          </div>
        </div>

        <div id="ai-prediction" class="card section">
          <div class="card-title"><i class="fas fa-robot"></i> AI Prediction</div>
          <div class="prediction-container">
            <div class="prediction-label">Next Prediction</div>
            <div id="prediction" class="prediction">—</div>
            <div class="prediction-label">Confidence: <span id="confidence">—</span></div>
            
            <div class="ai-analysis">
              <i class="fas fa-lightbulb"></i> <strong>AI Analysis:</strong>
              <span id="aiAnalysis">Waiting for data...</span>
            </div>
          </div>
        </div>

        <div id="performance" class="card section">
          <div class="card-title"><i class="fas fa-trophy"></i> Performance</div>
          <div class="stats">
            <div class="stat">
              <div class="stat-label">Prediction Accuracy</div>
              <div class="stat-value" id="accuracy">0%</div>
            </div>
            <div class="stat">
              <div class="stat-label">Virtual Profit</div>
              <div class="stat-value profit-stat" id="virtualProfit">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">Win Rate</div>
              <div class="stat-value" id="winRate">0%</div>
            </div>
            <div class="stat">
              <div class="stat-label">Recommended Bet</div>
              <div class="stat-value" id="recommendedBet">—</div>
            </div>
          </div>
          
          <div class="trend-chart" id="trendChart">
          </div>
        </div>

        <div id="history" class="card section" >
          <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px;">
            <div>
              <span id="status" class="status" style="font-size: 12px;"><i class="fas fa-check-circle"></i>Ready</span>
            </div>
          </div>

          <div id="error" class="error" style="display: none"></div>

          <table id="historyTable" style="display: none;">
            <thead>
              <tr>
                <th>#</th>
                <th>Last Digit</th>
                <th>Result</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
    <div style="text-align: center;">Developed by Dream</div>
  </div>

  <script>

    document.addEventListener('DOMContentLoaded', function() {

      document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        showMessage('Right-click is disabled for security reasons');
      });
      
      document.addEventListener('keydown', function(e) {
        if (
          e.key === 'F12' ||
          (e.ctrlKey && e.shiftKey && e.key === 'I') ||
          (e.ctrlKey && e.shiftKey && e.key === 'C') ||
          (e.ctrlKey && e.key === 'U')
        ) {
          e.preventDefault();
          showMessage('This action is disabled for security reasons');
        }
      });
      

      const passwordInput = document.getElementById('passwordInput');
      const loginBtn = document.getElementById('loginBtn');
      const message = document.getElementById('message');
      const loginScreen = document.getElementById('loginScreen');
      const predictionContent = document.getElementById('predictionContent');
      

      function checkPassword(input) {
        const encoded = [54, 108, 111, 116, 116, 101, 114, 121, 32, 86, 73, 80];
        const decoded = encoded.map(c => String.fromCharCode(c)).join('');
        return input === decoded;
      }
      
      function showMessage(text) {
        message.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${text}`;
        message.style.display = 'block';
        setTimeout(() => {
          message.style.display = 'none';
        }, 3000);
      }
      
      loginBtn.addEventListener('click', function() {
        const password = passwordInput.value;
        
        if (checkPassword(password)) {
          loginScreen.style.opacity = '0';
          setTimeout(() => {
            loginScreen.style.display = 'none';
            predictionContent.style.display = 'block';
          }, 500);
        } else {
          showMessage('Incorrect password. Please try again.');
          passwordInput.value = '';
          passwordInput.style.animation = 'shake 0.5s';
          setTimeout(() => {
            passwordInput.style.animation = '';
          }, 500);
        }
      });
      

      passwordInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          loginBtn.click();
        }
      });
      

      const menuItems = document.querySelectorAll('.menu-item');
      const sections = document.querySelectorAll('.section');
      
      menuItems.forEach(item => {
        item.addEventListener('click', () => {
          menuItems.forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          
          sections.forEach(s => s.classList.remove('active'));
          document.getElementById(item.dataset.section).classList.add('active');
        });
      });
      
      const API_URL = "https://6lotteryapi.com/api/webapi/GetNoaverageEmerdList";
      const API_PAYLOAD = {
        "pageSize": 10,
        "pageNo": 1,
        "typeId": 1,
        "language": 7,
        "random": "661e4d8000524e3a98ef5a3d4e0da7f1",
        "signature": "DF1807D59AC56BF25C1804140E4BF6A5",
        "timestamp": 1757564692
      };
      const HEADERS = {"Content-Type": "application/json"};

      const fetchBtn = document.getElementById("fetchBtn");
      const statusSpan = document.getElementById("status");
      const historyTable = document.getElementById("historyTable");
      const tbody = historyTable.querySelector("tbody");
      const bigCountEl = document.getElementById("bigCount");
      const smallCountEl = document.getElementById("smallCount");
      const totalCountEl = document.getElementById("totalCount");
      const bigRatioEl = document.getElementById("bigRatio");
      const currentStreakEl = document.getElementById("currentStreak");
      const maxStreakEl = document.getElementById("maxStreak");
      const predictionEl = document.getElementById("prediction");
      const confidenceEl = document.getElementById("confidence");
      const aiAnalysisEl = document.getElementById("aiAnalysis");
      const accuracyEl = document.getElementById("accuracy");
      const virtualProfitEl = document.getElementById("virtualProfit");
      const winRateEl = document.getElementById("winRate");
      const recommendedBetEl = document.getElementById("recommendedBet");
      const errorEl = document.getElementById("error");
      const trendChartEl = document.getElementById("trendChart");

      let historyData = [];
      let streak = 0;
      let maxStreak = 0;
      let virtualBalance = 1000;
      let wins = 0;
      let losses = 0;

      function setStatus(text, isSuccess = true) {
        statusSpan.innerHTML = isSuccess 
          ? `<i class="fas fa-check-circle"></i>${text}`
          : `<i class="fas fa-exclamation-triangle"></i>${text}`;
      }

      function showError(msg) {
        errorEl.style.display = "block";
        errorEl.textContent = msg;
      }

      function clearError() {
        errorEl.style.display = "none";
        errorEl.textContent = "";
      }

      function analyzeAndPredict(historyList) {
        const lastResults = [];
        let bigCount = 0, smallCount = 0;
        
        bigCount = 0;
        smallCount = 0;

        historyList.forEach((h, idx) => {
          const rawNum = (h.number ?? h.num ?? h.result ?? h.value ?? "").toString();
          let lastDigitChar = null;
          
          for (let i = rawNum.length - 1; i >= 0; i--) {
            if (/\d/.test(rawNum[i])) {
              lastDigitChar = rawNum[i];
              break;
            }
          }
          
          let d = null;
          if (lastDigitChar !== null) d = parseInt(lastDigitChar, 10);
          
          if (d === null) {
            const m = rawNum.match(/\d/);
            d = m ? parseInt(m[0], 10) : 0;
          }

          const res = (d >= 5) ? "BIG" : "SMALL";
          if (res === "BIG") bigCount++; else smallCount++;
          
          lastResults.push({
            index: idx + 1, 
            original: rawNum, 
            lastDigit: d, 
            result: res, 
            raw: h,
            isBig: res === "BIG"
          });
        });

        const total = lastResults.length;
        const bigRatio = total > 0 ? (bigCount / total * 100).toFixed(1) : 0;
        
        let currentStreak = 0;
        let currentType = null;
        
        for (let i = lastResults.length - 1; i >= 0; i--) {
          if (currentType === null) {
            currentType = lastResults[i].result;
            currentStreak = 1;
          } else if (lastResults[i].result === currentType) {
            currentStreak++;
          } else {
            break;
          }
        }
        
        if (currentStreak > maxStreak) {
          maxStreak = currentStreak;
        }
        
        let prediction = "—";
        let confidence = "50%";
        let aiAnalysis = "Insufficient data for analysis";
        
        if (lastResults.length > 2) {
          const lastResult = lastResults[lastResults.length - 1].result;
          const secondLastResult = lastResults[lastResults.length - 2].result;
          
          const randomFactor = Math.random();
          const trendFactor = bigCount > smallCount ? 0.7 : 0.3;
          const streakFactor = currentStreak > 3 ? 0.8 : 0.5;
          
          const bigProbability = (trendFactor * 0.4 + streakFactor * 0.3 + randomFactor * 0.3) * 100;
          
          if (bigProbability > 55) {
            prediction = "BIG";
            confidence = `${Math.min(95, Math.round(bigProbability))}%`;
            aiAnalysis = `Trend analysis shows ${bigRatio}% BIG results with ${currentStreak}-result streak. HIGH confidence in BIG.`;
          } else if (bigProbability < 45) {
            prediction = "SMALL";
            confidence = `${Math.min(95, Math.round(100 - bigProbability))}%`;
            aiAnalysis = `Trend analysis shows ${(100 - bigRatio).toFixed(1)}% SMALL results with ${currentStreak}-result streak. HIGH confidence in SMALL.`;
          } else {
            prediction = lastResult === "BIG" ? "SMALL" : "BIG";
            confidence = "55%";
            aiAnalysis = `Market is balanced. Using anti-trend strategy: after ${lastResult}, predicting ${prediction}.`;
          }
          
          if (prediction === lastResult) {
            virtualBalance += 95;
            wins++;
          } else {
            virtualBalance -= 100;
            losses++;
          }
          
          const accuracy = total > 0 ? (wins / (wins + losses) * 100).toFixed(1) : 0;
          const winRate = total > 0 ? (wins / total * 100).toFixed(1) : 0;
          
          const recommendedBet = Math.max(10, Math.min(500, Math.round(virtualBalance * 0.02)));
          
          accuracyEl.textContent = `${accuracy}%`;
          virtualProfitEl.textContent = `${virtualBalance - 1000}`;
          winRateEl.textContent = `${winRate}%`;
          recommendedBetEl.textContent = recommendedBet;
          
          if (virtualBalance > 1000) {
            virtualProfitEl.className = "stat-value profit-stat";
          } else if (virtualBalance < 1000) {
            virtualProfitEl.className = "stat-value loss-stat";
          }
        }
        
        return {
          lastResults, 
          bigCount, 
          smallCount, 
          prediction, 
          confidence,
          aiAnalysis,
          bigRatio,
          currentStreak,
          maxStreak,
          total
        };
      }

      function renderHistory(analyzed) {
        tbody.innerHTML = "";
        analyzed.lastResults.slice(0, 5).forEach(item => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${item.index}</td>
            <td>${item.lastDigit}</td>
            <td><span class="badge ${item.result === 'BIG' ? 'badge-big' : 'badge-small'}">${item.result}</span></td>
          `;
          tbody.appendChild(tr);
        });
        
        historyTable.style.display = analyzed.lastResults.length ? "table" : "none";
        
        bigCountEl.textContent = analyzed.bigCount;
        smallCountEl.textContent = analyzed.smallCount;
        totalCountEl.textContent = analyzed.total;
        bigRatioEl.textContent = `${analyzed.bigRatio}%`;
        currentStreakEl.textContent = analyzed.currentStreak;
        maxStreakEl.textContent = analyzed.maxStreak;
        
        predictionEl.textContent = analyzed.prediction;
        predictionEl.className = "prediction " + (analyzed.prediction === "BIG" ? "big" : (analyzed.prediction === "SMALL" ? "smallc" : ""));
        confidenceEl.textContent = analyzed.confidence;
        aiAnalysisEl.textContent = analyzed.aiAnalysis;
        
        predictionEl.classList.add("pulse");
        setTimeout(() => predictionEl.classList.remove("pulse"), 2000);
        
        updateTrendChart(analyzed.lastResults);
      }

      function updateTrendChart(results) {
        trendChartEl.innerHTML = "";
        
        const displayResults = results.slice(-10);
        
        displayResults.forEach((result, index) => {
          const bar = document.createElement("div");
          const height = result.isBig ? 70 : 30;
          
          bar.className = `bar ${result.isBig ? "bar-big" : "bar-small"}`;
          bar.style.height = `${height}%`;
          
          const label = document.createElement("div");
          label.className = "bar-label";
          label.textContent = result.index;
          
          bar.appendChild(label);
          trendChartEl.appendChild(bar);
        });
      }

      function escapeHtml(s) {
        if (typeof s !== "string") s = String(s);
        return s.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;");
      }

      async function fetchHistory() {
        clearError();
        setStatus("Fetching data...", true);
        
        try {
          const resp = await fetch(API_URL, {
            method: "POST",
            headers: HEADERS,
            body: JSON.stringify(API_PAYLOAD)
          });

          if (!resp.ok) {
            const txt = await resp.text().catch(() => "");
            throw new Error(`HTTP ${resp.status} ${resp.statusText} ${txt ? ' - ' + txt : ''}`);
          }

          const json = await resp.json();

          let list = null;
          if (Array.isArray(json.data?.list)) list = json.data.list;
          else if (Array.isArray(json.data)) list = json.data;
          else if (Array.isArray(json.list)) list = json.list;
          else {
            const possible = Object.values(json).find(v => Array.isArray(v));
            if (possible) list = possible;
          }

          if (!Array.isArray(list)) {
            throw new Error("API response doesn't contain expected list/array. Check console for full JSON.");
          }

          historyData = list;
          const analyzed = analyzeAndPredict(list);
          renderHistory(analyzed);
          setStatus("Data loaded successfully", true);
          
        } catch (err) {
          console.error("Fetch error:", err);
          let msg = err.message || String(err);
          
          if (msg.toLowerCase().includes("cors") || msg.toLowerCase().includes("access-control")) {
            msg += " — CORS restriction detected. Use a server-side proxy or CORS extension.";
          }
          
          showError(msg);
          setStatus("Error occurred", false);
        }
      }

      fetchBtn.addEventListener("click", fetchHistory);
    });
  </script>
</body>
</html>
