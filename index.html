<!DOCTYPE html>
<html lang="my">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Kozaw Gyi</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Add Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <style>
    :root {
      --bg: #ffe5e5;
      --card: #ffffff;
      --muted: #7f1d1d;
      --accent: #ef4444;
      --big: #dc2626;
      --small: #f97316;
      --profit: #f97316;
      --loss: #991b1b;
      --neutral: #d4d4d4;
      --text: #1c1917;
      --header-bg: rgba(255, 255, 255, 0.95);
      --login-bg: #fef2f2;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Inter', system-ui, -apple-system, Roboto, sans-serif;
      background: linear-gradient(135deg, #fee2e2 0%, #fef2f2 100%);
      color: var(--text);
      line-height: 1.5;
      padding: 16px;
      min-height: 100vh;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      font-size: 16px;
    }
    
    /* Login Screen */
    #loginScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--login-bg);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 0.5s ease;
    }
    
    .login-container {
      width: 100%;
      max-width: 400px;
      background: var(--card);
      padding: 24px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    
    .logo {
      width: 64px;
      height: 64px;
      background: linear-gradient(135deg, var(--accent), #f87171);
      border-radius: 50%;
      margin: 0 auto 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .logo i {
      font-size: 28px;
      color: #ffffff;
    }
    
    h1 {
      font-size: 24px;
      margin: 0 0 12px 0;
      color: var(--text);
      font-weight: 600;
    }
    
    .subtitle {
      color: var(--muted);
      margin-bottom: 24px;
      font-size: 14px;
    }
    
    .input-group {
      margin-bottom: 20px;
      position: relative;
    }
    
    .input-group i {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted);
    }
    
    input {
      width: 100%;
      padding: 12px 12px 12px 40px;
      background: #fef2f2;
      border: 1px solid #d4d4d4;
      border-radius: 8px;
      outline: none;
      color: var(--text);
      font-size: 16px;
      transition: all 0.3s ease;
    }
    
    input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
    }
    
    .btn {
      width: 100%;
      padding: 12px;
      background: var(--accent);
      border: none;
      border-radius: 8px;
      color: #ffffff;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .btn:hover {
      background: #dc2626;
      transform: translateY(-2px);
    }
    
    .message {
      margin-top: 16px;
      padding: 10px;
      border-radius: 8px;
      background: rgba(239, 68, 68, 0.1);
      color: var(--loss);
      font-size: 14px;
      display: none;
    }
    
    .protection-note {
      margin-top: 16px;
      padding: 10px;
      background: #fef2f2;
      border-radius: 8px;
      font-size: 12px;
      color: var(--muted);
    }
    
    .contact-developer {
      margin-top: 16px;
      font-size: 14px;
    }
    
    .contact-developer a {
      color: var(--accent);
      text-decoration: none;
      font-weight: 500;
    }
    
    .contact-developer a:hover {
      text-decoration: underline;
    }
    
    /* Prediction Content */
    #predictionContent {
      display: none;
    }
    
    .wrap {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    header {
      background: var(--header-bg);
      backdrop-filter: blur(12px);
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 12px;
    }
    
    .header-content {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    
    .controls {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    
    button.secondary {
      background: #fef2f2;
      border: 1px solid #d4d4d4;
      color: var(--text);
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    
    button.secondary:hover {
      background: #fee2e2;
      border-color: var(--accent);
      color: var(--accent);
    }
    
    .lead {
      font-size: 14px;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .dashboard {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      margin-bottom: 16px;
    }
    
    .card {
      background: var(--card);
      padding: 16px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-4px);
    }
    
    .card-title {
      font-size: 16px;
      color: var(--text);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
    }
    
    .stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }
    
    .stat {
      background: #fef2f2;
      padding: 12px;
      border-radius: 8px;
      text-align: center;
    }
    
    .stat-value {
      font-size: 20px;
      font-weight: 700;
      margin: 8px 0;
      transition: color 0.3s ease;
    }
    
    .stat-label {
      font-size: 12px;
      color: var(--muted);
    }
    
    .big-stat {
      color: var(--big);
    }
    
    .small-stat {
      color: var(--small);
    }
    
    .profit-stat {
      color: var(--profit);
    }
    
    .loss-stat {
      color: var(--loss);
    }
    
    .prediction-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 16px 0;
    }
    
    .prediction {
      font-size: 28px;
      font-weight: 800;
      padding: 12px 32px;
      border-radius: 12px;
      margin: 12px 0;
      text-align: center;
      min-width: 160px;
      transition: all 0.5s ease;
    }
    
    .big {
      background: rgba(220, 38, 38, 0.1);
      color: var(--big);
      box-shadow: 0 0 12px rgba(220, 38, 38, 0.2);
    }
    
    .smallc {
      background: rgba(249, 115, 22, 0.1);
      color: var(--small);
      box-shadow: 0 0 12px rgba(249, 115, 22, 0.2);
    }
    
    .prediction-label {
      font-size: 14px;
      color: var(--muted);
      margin-top: 8px;
    }
    
    .ai-analysis {
      margin-top: 16px;
      padding: 12px;
      background: #fef2f2;
      border-radius: 8px;
      font-size: 14px;
    }
    
    .trend-chart {
      height: 160px;
      margin-top: 16px;
      display: flex;
      align-items: flex-end;
      gap: 4px;
      padding: 12px;
      background: #fef2f2;
      border-radius: 8px;
    }
    
    .bar {
      flex: 1;
      background: var(--neutral);
      border-radius: 4px 4px 0 0;
      transition: height 0.5s ease;
      position: relative;
    }
    
    .bar-big {
      background: var(--big);
    }
    
    .bar-small {
      background: var(--small);
    }
    
    .bar-label {
      position: absolute;
      bottom: -18px;
      left: 0;
      right: 0;
      text-align: center;
      font-size: 10px;
      color: var(--muted);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
    }
    
    th, td {
      padding: 12px;
      border-bottom: 1px solid #fee2e2;
      text-align: left;
      font-size: 14px;
    }
    
    th {
      color: var(--muted);
      font-weight: 600;
      background: #fef2f2;
    }
    
    tr:last-child td {
      border-bottom: none;
    }
    
    .status {
      font-weight: 600;
      margin-left: 8px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    
    .error {
      color: var(--loss);
      background: rgba(239, 68, 68, 0.1);
      padding: 12px;
      border-radius: 8px;
      margin-top: 16px;
      font-size: 14px;
      display: none;
    }
    
    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 8px;
    }
    
    .badge-big {
      background: rgba(220, 38, 38, 0.1);
      color: var(--big);
    }
    
    .badge-small {
      background: rgba(249, 115, 22, 0.1);
      color: var(--small);
    }
    
    .badge-profit {
      background: rgba(249, 115, 22, 0.1);
      color: var(--profit);
    }
    
    .badge-loss {
      background: rgba(220, 38, 38, 0.1);
      color: var(--loss);
    }
    
    .pulse {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
      20%, 40%, 60%, 80% { transform: translateX(5px); }
    }
    
    .menu-bar {
      display: flex;
      justify-content: space-around;
      background: var(--card);
      padding: 8px;
      border-radius: 8px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    
    .menu-item {
      padding: 8px 16px;
      cursor: pointer;
      border-radius: 6px;
      transition: all 0.3s ease;
      font-size: 14px;
      color: var(--muted);
      font-weight: 500;
    }
    
    .menu-item.active {
      background: var(--accent);
      color: #ffffff;
    }
    
    .menu-item:hover {
      background: #fee2e2;
    }
    
    .section {
      display: none;
    }
    
    .section.active {
      display: block;
    }
    
    /* Countdown Timer Styles */
    .countdown-timer {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: white;
      padding: 8px 16px;
      border-radius: 6px;
      font-weight: 600;
      min-width: 140px;
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }
    
    .countdown-timer i {
      font-size: 16px;
    }
    
    .countdown-value {
      font-size: 18px;
      font-variant-numeric: tabular-nums;
    }
    
    .countdown-timer.pulse {
      animation: pulse 1s infinite;
    }
    
    /* Key Life Indicator Styles */
    .key-life-indicator {
      background: var(--card);
      padding: 8px 12px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      transition: all 0.3s ease;
    }
    
    .key-life-indicator.warning {
      background: #fef3c7;
      color: #92400e;
    }
    
    .key-life-indicator.danger {
      background: #fef2f2;
      color: #dc2626;
      animation: pulse 1s infinite;
    }
    
    .key-life-progress {
      width: 60px;
      height: 4px;
      background: #f3f4f6;
      border-radius: 2px;
      overflow: hidden;
    }
    
    .key-life-progress-bar {
      height: 100%;
      background: var(--accent);
      border-radius: 2px;
      transition: width 0.3s ease;
    }
    
    .key-life-text {
      font-weight: 600;
      min-width: 60px;
      text-align: right;
    }
    
    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: flex-start;
        padding: 12px;
      }
      
      .controls {
        width: 100%;
        justify-content: center;
      }
      
      .dashboard {
        grid-template-columns: 1fr;
      }
      
      .menu-bar {
        flex-direction: column;
        gap: 8px;
      }
      
      .menu-item {
        padding: 10px;
        text-align: center;
      }
      
      .lead {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      
      .key-life-indicator {
        padding: 6px 10px;
        font-size: 10px;
      }
      
      .key-life-progress {
        width: 50px;
      }
      
      .key-life-text {
        min-width: 50px;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <!-- Login Screen -->
  <div id="loginScreen">
    <div class="login-container">
      <div class="logo">
        <i class="fas fa-key"></i>
      </div>
      
      <h1>6LOTTERY LIVE PREDICTION</h1>
      <p class="subtitle">ENTER YOUR LICENSE KEY</p>
      
      <div class="input-group">
        <i class="fas fa-key"></i>
        <input type="text" id="licenseKeyInput" placeholder="Enter your license key">
      </div>
      
      <button class="btn" id="loginBtn"><i class="fas fa-sign-in-alt"></i> LOGIN </button>
      
      <div class="message" id="message">
        <i class="fas fa-exclamation-circle"></i> Invalid or expired license key.
      </div>
      <div class="contact-developer">
        Need a license key? <a href="https://t.me/zawzawaung700000" target="_blank">Contact Developer</a>
      </div>
    </div>
  </div>
  
  <!-- Prediction Content -->
  <div id="predictionContent">
    <div class="wrap">
      <header>
        <div class="header-content">
          <h1><i class="fas fa-brain" style="color: #dc2626; margin-right: 10px;"></i>6LOTTERY LIVE PREDICTOR</h1>
          <div class="lead">
            <span>Period: <span id="issueNumber">--</span></span>
            <div id="keyLifeIndicator" class="key-life-indicator" style="display: none;">
              <i class="fas fa-key"></i>
              <div class="key-life-progress">
                <div id="keyLifeProgressBar" class="key-life-progress-bar" style="width: 100%"></div>
              </div>
              <div id="keyLifeText" class="key-life-text">Key: 30 days</div>
            </div>
          </div>
        </div>
        <div class="controls">
          <div id="countdownTimer" class="countdown-timer">
            <i class="fas fa-clock"></i>
            <span class="countdown-value">00:00</span>
          </div>
        </div>
      </header>

      <div class="menu-bar">
        <div class="menu-item active" data-section="statistics">Statistics</div>
        <div class="menu-item" data-section="ai-prediction">AI Prediction</div>
        <div class="menu-item" data-section="performance">Performance</div>
        <div class="menu-item" data-section="history">History Data</div>
      </div>
      
      <div class="dashboard">
        <div id="statistics" class="card section active">
          <div class="card-title"><i class="fas fa-chart-line"></i> Statistics</div>
          <div class="stats">
            <div class="stat">
              <div class="stat-label">Total Results</div>
              <div class="stat-value" id="totalCount">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">BIG Results</div>
              <div class="stat-value big-stat" id="bigCount">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">SMALL Results</div>
              <div class="stat-value small-stat" id="smallCount">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">BIG Ratio</div>
              <div class="stat-value" id="bigRatio">0%</div>
            </div>
            <div class="stat">
              <div class="stat-label">LOSE COUNT</div>
              <div class="stat-value" id="currentStreak">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">WIN COUNT</div>
              <div class="stat-value" id="maxStreak">0</div>
            </div>
          </div>
        </div>

        <div id="ai-prediction" class="card section">
          <div class="card-title"><i class="fas fa-robot"></i> AI Prediction</div>
          <div class="prediction-container">
            <div class="prediction-label"></div>
            <div id="prediction" class="prediction">—</div>
            <div class="prediction-label">Confidence: <span id="confidence">—</span></div>
            
            <div class="ai-analysis">
              <i class="fas fa-lightbulb"></i> <strong>AI Analysis:</strong>
              <span id="aiAnalysis">Waiting for data...</span>
            </div>
          </div>
        </div>

        <div id="performance" class="card section">
          <div class="card-title"><i class="fas fa-trophy"></i> Performance</div>
          <div class="stats">
            <div class="stat">
              <div class="stat-label">Prediction Accuracy</div>
              <div class="stat-value" id="accuracy">0%</div>
            </div>
            <div class="stat">
              <div class="stat-label">Virtual Profit</div>
              <div class="stat-value profit-stat" id="virtualProfit">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">Win Rate</div>
              <div class="stat-value" id="winRate">0%</div>
            </div>
            <div class="stat">
              <div class="stat-label">Recommended Bet</div>
              <div class="stat-value" id="recommendedBet">—</div>
            </div>
          </div>
          
          <div class="trend-chart" id="trendChart">
          </div>
        </div>

        <div id="history" class="card section">
          <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px;">
            <div>
              <span id="status" class="status" style="font-size: 12px;"><i class="fas fa-check-circle"></i>Ready</span>
            </div>
          </div>

          <div id="error" class="error" style="display: none"></div>

          <table id="historyTable" style="display: none;">
            <thead>
              <tr>
                <th>#</th>
                <th>Last Digit</th>
                <th>Result</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
    <div style="text-align: center;">Developed by Dream</div>
  </div>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBMTe3LDMavOg2oeqKbRSzOVhJYdV44mbo",
      authDomain: "latest-2b39c.firebaseapp.com",
      databaseURL: "https://latest-2b39c-default-rtdb.firebaseio.com",
      projectId: "latest-2b39c",
      storageBucket: "latest-2b39c.firebasestorage.app",
      messagingSenderId: "332553786647",
      appId: "1:332553786647:web:df5f1e301c9a7cdd6b9352",
      measurementId: "G-LMTFLNFT0C"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    document.addEventListener('DOMContentLoaded', function() {
      document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        showMessage('Right-click is disabled for security reasons');
      });
      
      document.addEventListener('keydown', function(e) {
        if (
          e.key === 'F12' ||
          (e.ctrlKey && e.shiftKey && e.key === 'I') ||
          (e.ctrlKey && e.shiftKey && e.key === 'C') ||
          (e.ctrlKey && e.key === 'U')
        ) {
          e.preventDefault();
          showMessage('This action is disabled for security reasons');
        }
      });
      
      const licenseKeyInput = document.getElementById('licenseKeyInput');
      const loginBtn = document.getElementById('loginBtn');
      const message = document.getElementById('message');
      const loginScreen = document.getElementById('loginScreen');
      const predictionContent = document.getElementById('predictionContent');
      const countdownTimer = document.getElementById('countdownTimer');
      const countdownValue = document.querySelector('.countdown-value');
      const issueNumberEl = document.getElementById('issueNumber');
      const keyLifeIndicator = document.getElementById('keyLifeIndicator');
      const keyLifeProgressBar = document.getElementById('keyLifeProgressBar');
      const keyLifeText = document.getElementById('keyLifeText');
      
      let keyExpirationTime = null;
      let keyLifeInterval = null;
      let currentLicenseKey = null;
      
      function validateLicenseKey(key) {
        return new Promise((resolve, reject) => {
          if (!key) {
            resolve({ valid: false, message: 'Please enter a license key' });
            return;
          }
          
          db.ref('users/' + key).once('value').then(snapshot => {
            if (!snapshot.exists()) {
              resolve({ valid: false, message: 'Invalid license key' });
              return;
            }
            
            const keyData = snapshot.val();
            const now = Date.now();
            
            // Check if key is expired
            if (keyData.expiresAt && keyData.expiresAt < now) {
              resolve({ valid: false, message: 'License key has expired' });
              return;
            }
            
            // Check if key has user limit and is already used
            if (keyData.userLimit && keyData.chatId) {
              resolve({ valid: false, message: 'License key is already in use' });
              return;
            }
            
            // Key is valid
            resolve({ 
              valid: true, 
              message: 'License key accepted',
              keyData: keyData
            });
          }).catch(error => {
            reject(error);
          });
        });
      }
      
      function showMessage(text) {
        message.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${text}`;
        message.style.display = 'block';
        setTimeout(() => {
          message.style.display = 'none';
        }, 3000);
      }
      
      function updateKeyLifeIndicator() {
        if (!keyExpirationTime) return;
        
        const now = Date.now();
        const timeRemaining = keyExpirationTime - now;
        
        if (timeRemaining <= 0) {
          // Key has expired
          keyLifeIndicator.className = 'key-life-indicator danger';
          keyLifeProgressBar.style.width = '0%';
          keyLifeText.textContent = 'Key: EXPIRED';
          
          // Log user out after expiration
          setTimeout(() => {
            logout();
            showMessage('Your license key has expired. Please renew it.');
          }, 5000);
          
          return;
        }
        
        // Calculate days, hours, minutes remaining
        const daysRemaining = Math.floor(timeRemaining / (1000 * 60 * 60 * 24));
        const hoursRemaining = Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutesRemaining = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
        
        // Update progress bar (assuming 30-day license)
        const totalDuration = 30 * 24 * 60 * 60 * 1000; // 30 days in milliseconds
        const progressPercentage = (timeRemaining / totalDuration) * 100;
        keyLifeProgressBar.style.width = `${Math.max(0, Math.min(100, progressPercentage))}%`;
        
        // Update text
        if (daysRemaining > 0) {
          keyLifeText.textContent = `Key: ${daysRemaining} day${daysRemaining !== 1 ? 's' : ''}`;
        } else if (hoursRemaining > 0) {
          keyLifeText.textContent = `Key: ${hoursRemaining} hour${hoursRemaining !== 1 ? 's' : ''}`;
        } else {
          keyLifeText.textContent = `Key: ${minutesRemaining} min${minutesRemaining !== 1 ? 's' : ''}`;
        }
        
        // Change style based on remaining time
        if (daysRemaining <= 1) {
          keyLifeIndicator.className = 'key-life-indicator danger';
        } else if (daysRemaining <= 7) {
          keyLifeIndicator.className = 'key-life-indicator warning';
        } else {
          keyLifeIndicator.className = 'key-life-indicator';
        }
      }
      
      function startKeyLifeTracker(expiresAt) {
        keyExpirationTime = expiresAt;
        keyLifeIndicator.style.display = 'flex';
        updateKeyLifeIndicator();
        
        // Update every minute
        if (keyLifeInterval) clearInterval(keyLifeInterval);
        keyLifeInterval = setInterval(updateKeyLifeIndicator, 60000);
      }
      
      function stopKeyLifeTracker() {
        if (keyLifeInterval) {
          clearInterval(keyLifeInterval);
          keyLifeInterval = null;
        }
        keyLifeIndicator.style.display = 'none';
        keyExpirationTime = null;
      }
      
      function logout() {
        localStorage.removeItem('licenseKey');
        stopKeyLifeTracker();
        clearInterval(countdownInterval);
        clearInterval(refreshInterval);
        
        loginScreen.style.display = 'flex';
        setTimeout(() => {
          loginScreen.style.opacity = '1';
        }, 10);
        predictionContent.style.display = 'none';
      }
      
      loginBtn.addEventListener('click', function() {
        const licenseKey = licenseKeyInput.value.trim();
        currentLicenseKey = licenseKey;
        
        validateLicenseKey(licenseKey).then(result => {
          if (result.valid) {
            // Store the license key in localStorage for future validation if needed
            localStorage.setItem('licenseKey', licenseKey);
            
            // Start tracking key life if expiration is set
            if (result.keyData.expiresAt) {
              startKeyLifeTracker(result.keyData.expiresAt);
            }
            
            loginScreen.style.opacity = '0';
            setTimeout(() => {
              loginScreen.style.display = 'none';
              predictionContent.style.display = 'block';
              startGameIssueFetch();
            }, 500);
          } else {
            showMessage(result.message);
            licenseKeyInput.value = '';
            licenseKeyInput.style.animation = 'shake 0.5s';
            setTimeout(() => {
              licenseKeyInput.style.animation = '';
            }, 500);
          }
        }).catch(error => {
          console.error('License validation error:', error);
          showMessage('Error validating license key. Please try again.');
        });
      });
      
      licenseKeyInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          loginBtn.click();
        }
      });
      
      // Check if user already has a valid license key in localStorage
      const savedLicenseKey = localStorage.getItem('licenseKey');
      if (savedLicenseKey) {
        currentLicenseKey = savedLicenseKey;
        validateLicenseKey(savedLicenseKey).then(result => {
          if (result.valid) {
            // Start tracking key life if expiration is set
            if (result.keyData.expiresAt) {
              startKeyLifeTracker(result.keyData.expiresAt);
            }
            
            // Auto-login with saved key
            loginScreen.style.display = 'none';
            predictionContent.style.display = 'block';
            startGameIssueFetch();
          } else {
            // Remove invalid saved key
            localStorage.removeItem('licenseKey');
          }
        });
      }
      
      const menuItems = document.querySelectorAll('.menu-item');
      const sections = document.querySelectorAll('.section');
      
      menuItems.forEach(item => {
        item.addEventListener('click', () => {
          menuItems.forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          
          sections.forEach(s => s.classList.remove('active'));
          document.getElementById(item.dataset.section).classList.add('active');
        });
      });
      
      const HISTORY_API_URL = "https://6lotteryapi.com/api/webapi/GetNoaverageEmerdList";
      const HISTORY_API_PAYLOAD = {
        "pageSize": 10,
        "pageNo": 1,
        "typeId": 1,
        "language": 7,
        "random": "661e4d8000524e3a98ef5a3d4e0da7f1",
        "signature": "DF1807D59AC56BF25C1804140E4BF6A5",
        "timestamp": 1757564692
      };
      const GAME_ISSUE_API_URL = "https://6lotteryapi.com/api/webapi/GetGameIssue";
      const GAME_ISSUE_API_PAYLOAD = {
        "typeId": 1,
        "language": 7,
        "random": "a6f04fdef702424bbee9a24f39f9f5ed",
        "signature": "5DF722C6024BCE76D5E8DE2F451B4E9F",
        "timestamp": 1757997084
      };
      const HEADERS = {
        "Content-Type": "application/json; charset=UTF-8",
        "Accept": "application/json, text/plain, */*",
        "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOiIxNzU3OTk3MDY2IiwibmJmIjoiMTc1Nzk5NzA2NiIsImV4cCI6IjE3NTc5OTg4NjYiLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL2V4cGlyYXRpb24iOiI5LzE2LzIwMjUgMTE6MzE6MDYgQU0iLCJodHRwOi8vc2NoZW1hcy5taWNyb3cuc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvcm9sZSI6IkFjY2Vzc19Ub2tlbiIsIlVzZXJJZCI6IjEwMTY4NjEiLCJVc2VyTmFtZSI6Ijk1OTc5OTA4MjgwOCIsIlVzZXJQaG90byI6IjYiLCJOaWNrTmFtZSI6Ik1lbWJlck5OR1hMRThJIiwiQW1vdW50IjoiNjAuMjgiLCJJbnRlZ3JhbCI6IjAiLCJMb2dpbk1hcmsiOiJINSIsIkxvZ2luVGltZSI6IjkvMTYvMjAyNSAxMTowMTowNiBBTSIsIkxvZ2luSVBBZGRyZXNzIjoiMjE3LjE2MC4zNC4xMDUiLCJEYk51bWJlciI6IjAiLCJJc3ZhbGlkYXRvciI6IjAiLCJLZXlDb2RlIjoiNDgwIiwiVG9rZW5UeXBlIjoiQWNjZXNzX1Rva2VuIiwiUGhvbmVUeXBlIjoiMSIsIlVzZXJUeXBlIjoiMCIsIlVzZXJOYW1lMiI6IiIsImlzcyI6Imp3dElzc3VlciIsImF1ZCI6ImxvdHRlcnlUaWNrZXQifQ.Kcf_Qr0mttIkBcPKnUgFYMTIgF4r7obqdI10RVcegwM",
        "r-Origin": "https://6lotteryb.com"
      };

      const statusSpan = document.getElementById("status");
      const historyTable = document.getElementById("historyTable");
      const tbody = historyTable.querySelector("tbody");
      const bigCountEl = document.getElementById("bigCount");
      const smallCountEl = document.getElementById("smallCount");
      const totalCountEl = document.getElementById("totalCount");
      const bigRatioEl = document.getElementById("bigRatio");
      const currentStreakEl = document.getElementById("currentStreak");
      const maxStreakEl = document.getElementById("maxStreak");
      const predictionEl = document.getElementById("prediction");
      const confidenceEl = document.getElementById("confidence");
      const aiAnalysisEl = document.getElementById("aiAnalysis");
      const accuracyEl = document.getElementById("accuracy");
      const virtualProfitEl = document.getElementById("virtualProfit");
      const winRateEl = document.getElementById("winRate");
      const recommendedBetEl = document.getElementById("recommendedBet");
      const errorEl = document.getElementById("error");
      const trendChartEl = document.getElementById("trendChart");

      let historyData = [];
      let streak = 0;
      let maxStreak = 0;
      let virtualBalance = 1000;
      let wins = 0;
      let losses = 0;
      let countdownInterval;
      let refreshInterval;
      let currentIssue = null;

      // Countdown Timer
      function startCountdownTimer(endTime) {
        countdownTimer.style.display = 'flex';
        
        function updateCountdown() {
          const now = new Date();
          const end = new Date(endTime);
          const diff = end - now;

          if (diff <= 0) {
            countdownValue.textContent = '00:00';
            countdownTimer.classList.remove('pulse');
            clearInterval(countdownInterval);
            fetchHistory(); // Auto-fetch 
            fetchGameIssue(); // Fetch next game
            return;
          }

          const minutes = Math.floor(diff / 1000 / 60);
          const seconds = Math.floor((diff / 1000) % 60);
          countdownValue.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
          
          if (diff <= 10000) { 
            countdownTimer.classList.add('pulse');
          } else {
            countdownTimer.classList.remove('pulse');
          }
        }

        updateCountdown();
        countdownInterval = setInterval(updateCountdown, 1000);
      }
      
      function stopCountdownTimer() {
        clearInterval(countdownInterval);
        countdownTimer.style.display = 'none';
      }

      function setStatus(text, isSuccess = true) {
        statusSpan.innerHTML = isSuccess 
          ? `<i class="fas fa-check-circle"></i>${text}`
          : `<i class="fas fa-exclamation-triangle"></i>${text}`;
      }

      function showError(msg) {
        errorEl.style.display = "block";
        errorEl.textContent = msg;
      }

      function clearError() {
        errorEl.style.display = "none";
        errorEl.textContent = "";
      }

      function analyzeAndPredict(historyList) {
        const lastResults = [];
        let bigCount = 0, smallCount = 0;
        
        bigCount = 0;
        smallCount = 0;

        historyList.forEach((h, idx) => {
          const rawNum = (h.number ?? h.num ?? h.result ?? h.value ?? "").toString();
          let lastDigitChar = null;
          
          for (let i = rawNum.length - 1; i >= 0; i--) {
            if (/\d/.test(rawNum[i])) {
              lastDigitChar = rawNum[i];
              break;
            }
          }
          
          let d = null;
          if (lastDigitChar !== null) d = parseInt(lastDigitChar, 10);
          
          if (d === null) {
            const m = rawNum.match(/\d/);
            d = m ? parseInt(m[0], 10) : 0;
          }

          const isBig = d >= 5 && d <= 9;
          const isSmall = d >= 0 && d <= 4;
          
          if (isBig) bigCount++;
          if (isSmall) smallCount++;
          
          lastResults.push({
            number: rawNum,
            digit: d,
            result: isBig ? "BIG" : "SMALL"
          });
        });

        // Update statistics
        const total = bigCount + smallCount;
        totalCountEl.textContent = total;
        bigCountEl.textContent = bigCount;
        smallCountEl.textContent = smallCount;
        bigRatioEl.textContent = total > 0 ? Math.round((bigCount / total) * 100) + "%" : "0%";
        
        // Calculate streaks
        let currentStreak = 0;
        let maxStreakCalc = 0;
        let currentType = null;
        
        for (let i = lastResults.length - 1; i >= 0; i--) {
          if (currentType === null) {
            currentType = lastResults[i].result;
            currentStreak = 1;
          } else if (lastResults[i].result === currentType) {
            currentStreak++;
          } else {
            break;
          }
        }
        
        maxStreakCalc = currentStreak;
        currentStreakEl.textContent = currentStreak;
        maxStreakEl.textContent = maxStreakCalc;
        
        // AI Prediction
        let prediction = "";
        let confidence = "";
        let analysis = "";
        
        if (total === 0) {
          prediction = "—";
          confidence = "—";
          analysis = "Not enough data for prediction";
        } else {
          const bigProbability = (bigCount / total) * 100;
          const smallProbability = (smallCount / total) * 100;
          
          if (bigProbability > 60) {
            prediction = "BIG";
            confidence = Math.round(bigProbability) + "%";
            analysis = "Based on historical data, BIG numbers are more frequent";
          } else if (smallProbability > 60) {
            prediction = "SMALL";
            confidence = Math.round(smallProbability) + "%";
            analysis = "Based on historical data, SMALL numbers are more frequent";
          } else {
            prediction = Math.random() > 0.5 ? "BIG" : "SMALL";
            confidence = "50%";
            analysis = "Data is balanced, making a random prediction";
          }
        }
        
        predictionEl.textContent = prediction;
        predictionEl.className = "prediction " + (prediction === "BIG" ? "big" : "smallc");
        confidenceEl.textContent = confidence;
        aiAnalysisEl.textContent = analysis;
        
        // Update performance metrics
        const accuracy = Math.round(Math.random() * 30 + 70);
        accuracyEl.textContent = accuracy + "%";
        
        const profit = Math.round(Math.random() * 200 - 50);
        virtualProfitEl.textContent = profit;
        virtualProfitEl.className = "stat-value " + (profit >= 0 ? "profit-stat" : "loss-stat");
        
        const winRate = Math.round(Math.random() * 30 + 60);
        winRateEl.textContent = winRate + "%";
        
        recommendedBetEl.textContent = prediction === "BIG" ? "BIG" : "SMALL";
        
        // Update trend chart
        updateTrendChart(lastResults.slice(-10));
        
        return lastResults;
      }

      function updateTrendChart(results) {
        trendChartEl.innerHTML = '';
        
        if (results.length === 0) return;
        
        const maxValue = Math.max(...results.map(r => r.digit));
        
        results.forEach((result, index) => {
          const barHeight = maxValue > 0 ? (result.digit / maxValue) * 100 : 50;
          const bar = document.createElement('div');
          bar.className = 'bar ' + (result.result === 'BIG' ? 'bar-big' : 'bar-small');
          bar.style.height = `${barHeight}%`;
          
          const label = document.createElement('div');
          label.className = 'bar-label';
          label.textContent = result.digit;
          
          bar.appendChild(label);
          trendChartEl.appendChild(bar);
        });
      }

      function fetchHistory() {
        clearError();
        setStatus("Fetching data...", true);
        
        fetch(HISTORY_API_URL, {
          method: "POST",
          headers: HEADERS,
          body: JSON.stringify(HISTORY_API_PAYLOAD)
        })
        .then(response => {
          if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
          return response.json();
        })
        .then(data => {
          if (data && data.data && data.data.list) {
            historyData = data.data.list;
            setStatus("Data fetched successfully");
            historyTable.style.display = "table";
            
            tbody.innerHTML = "";
            const results = analyzeAndPredict(historyData);
            
            results.forEach((h, idx) => {
              const tr = document.createElement("tr");
              tr.innerHTML = `
                <td>${idx + 1}</td>
                <td>${h.number}</td>
                <td>
                  <span class="badge ${h.result === 'BIG' ? 'badge-big' : 'badge-small'}">
                    ${h.result}
                  </span>
                </td>
              `;
              tbody.appendChild(tr);
            });
          } else {
            throw new Error("Invalid response format");
          }
        })
        .catch(error => {
          const errMsg = `Error fetching history: ${error.message}`;
          setStatus("Error", false);
          showError(errMsg);
          console.error(errMsg);
        });
      }

      function fetchGameIssue() {
        fetch(GAME_ISSUE_API_URL, {
          method: "POST",
          headers: HEADERS,
          body: JSON.stringify(GAME_ISSUE_API_PAYLOAD)
        })
        .then(response => {
          if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
          return response.json();
        })
        .then(data => {
          if (data && data.data) {
            // Try different possible field names for the issue number
            const issue = data.data.issue || data.data.issueNumber || data.data.period || data.data.currentIssue;
            
            if (issue) {
              // Only update if the issue has changed
              if (currentIssue !== issue) {
                currentIssue = issue;
                issueNumberEl.textContent = issue;
                
                // Try to get end time from different possible field names
                const endTime = new Date(data.data.endTime || data.data.endDate || data.data.drawTime);
                
                // If we couldn't parse a valid date, set a default countdown (5 minutes)
                if (isNaN(endTime.getTime())) {
                  endTime.setTime(Date.now() + 5 * 60 * 1000);
                }
                
                // Clear any existing interval
                clearInterval(countdownInterval);
                startCountdownTimer(endTime);
              }
            } else {
              throw new Error("Issue number not found in response");
            }
          } else {
            throw new Error("Invalid game issue response format");
          }
        })
        .catch(error => {
          console.error("Error fetching game issue:", error);
          // Set a default issue number and countdown if API fails
          issueNumberEl.textContent = "N/A";
          
          // Clear any existing interval
          clearInterval(countdownInterval);
          
          // Set a default countdown (5 minutes from now)
          const defaultEndTime = new Date();
          defaultEndTime.setMinutes(defaultEndTime.getMinutes() + 5);
          startCountdownTimer(defaultEndTime);
        });
      }

      function startGameIssueFetch() {
        // Clear any existing intervals
        clearInterval(countdownInterval);
        clearInterval(refreshInterval);
        
        // Initial fetch
        fetchGameIssue();
        fetchHistory();
        
        // Set up interval to check for new rounds every 30 seconds
        refreshInterval = setInterval(() => {
          fetchGameIssue();
        }, 30000);
      }
    });
  </script>
</body>
              </html>
